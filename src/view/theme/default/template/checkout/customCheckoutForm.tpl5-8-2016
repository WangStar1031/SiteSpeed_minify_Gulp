<?php if(isset($redirect) && !empty($redirect)){?><div class="alert alert-danger"><i class="fa fa-exclamation-circle"></i> <a href="<?php echo $redirect; ?>">Location not set. Please <span style="font-weight:bold;">Click Here</span> to go back to Ordering Options.</a>    <button type="button" class="close" data-dismiss="alert">&times;</button></div>	<?php }else{ ?><div id="custom-checkout-form">	<div id="custom-checkout-form_part_1">		<div id="checkout-form-contact" class="col-sm-6 col-sm-offset-3 checkout-container clearfix">			<div class="checkout-container-header full-width">				<h4>Contact</h4>			</div>			<div id="checkout_contact" class="checkout-container-content">			  <div class="row form-group required">				<label class="col-sm-2 control-label" for="firstname">Name</label>				<div class="col-sm-5 mobile-mb10">				  <input name="firstname" class="form-control" type="text" id="checkout_contact_firstname" value="<?php echo $firstname; ?>" placeholder="First Name" >				</div>				<div class="col-sm-5">				  <input name="lastname" class="form-control" type="text" id="checkout_contact_lastname" value="<?php echo $lastname; ?>" placeholder="Last Name">				</div>			  </div>			  <div class="row form-group required">				<label class="col-sm-2 control-label" for="email">Email</label>				<div class="col-sm-10">				  <input name="email" class="form-control" type="email" id="checkout_contact_email" value="<?php echo $email; ?>" placeholder="E-Mail Address">				</div>			  </div>			  <div class="row form-group required">				<label class="col-sm-2 control-label" for="phone">Phone</label>				<div class="col-sm-10">				  <input name="telephone" class="form-control" type="text" id="checkout_contact_telephone" value="<?php echo $telephone; ?>" placeholder="Telephone">				  <input name="fax" class="form-control" type="hidden" id="fax" value="<?php echo $fax; ?>">				  <input name="customer_id" class="form-control" type="hidden" id="customer_id" value="<?php echo $customer_id; ?>">				</div>			  </div>			</div>		</div>				<div id="checkout-form-method" class="col-sm-6 col-sm-offset-3 checkout-container clearfix">			<div class="checkout-container-header full-width">				<h4>Order Details</h4>			</div>						<?php				$showPickup = false;				if(isset($_SESSION['pickupStatus']) && !empty($_SESSION['pickupStatus'])){					$showPickup = true;				}								$showDelivery = false;				if(isset($_SESSION['deliveryStatus']) && !empty($_SESSION['deliveryStatus'])){					$showDelivery = true;				}							?>						<?php if($showPickup && $showDelivery){ ?>			<div id="checkout_method" class="checkout-container-content">			  <div class="row form-group">				<div class="col-sm-6 text-center mobile-mb10">				  <a id="showPickupSection" onclick="showSelectedMethodSection(this.id)" href="javascript:void(0);"><div class="full-width" style="padding:3%;background-color:#f0f0f0;border:1px solid #ddd; border-radius:5px;">Pickup</div></a>				</div>				<div id="showDeliverySection" onclick="showSelectedMethodSection(this.id)" class="col-sm-6 text-center">				  <a href="javascript:void(0);"><div class="full-width" style="padding:3%;background-color:#f0f0f0;border:1px solid #ddd; border-radius:5px;">Delivery</div></a>				</div>			  </div>			  			  <div id="pickup_section" class="row form-group">				<div class="col-sm-12 text-left">				  <h4>Pickup Location</h4>				  <p>					<?php echo $pickup_address['title']; ?><br/>					<?php echo $pickup_address['display_address']; ?>				  </p>				</div>			  </div>			  			  <div id="delivery_address_section" class="row form-group">				<div class="col-sm-6 col-md-6 col-lg-8">													<input class="form-control input-lg" type="text" id="full_delivery_address" placeholder="Enter your address..." value="<?php echo $full_delivery_address; ?>" name="full_delivery_address" autocomplete="false">										<!-- The table below is used by Google Maps API to post the address as individual value						for street number, city, state, zip code and country -->					<table id="address" style="display:none">					  <tr>						<td class="label">Street address</td>						<td class="slimField">							<input class="field" value="<?php echo $street_number; ?>" id="street_number"	disabled="true"></input>						</td>					  </tr>					  <tr>						<td class="label">Route/Address 2</td>							<td class="wideField" colspan="2">							<input class="field" value="<?php echo $route; ?>" id="route" disabled="true"></input>						</td>					  </tr>					  <tr>						<td class="label">City</td>						<td class="wideField" colspan="3"><input value="<?php echo $locality; ?>" class="field" id="locality" disabled="true"></input></td>					  </tr>					  <tr>						<td class="label">State</td>						<td class="slimField"><input class="field" id="administrative_area_level_1" value="<?php echo $administrative_area_level_1; ?>" disabled="true"></input></td>					<tr>		  					</tr>		  						<td class="label">Zip code</td>						<td class="wideField"><input value="<?php echo $postal_code; ?>" class="field" id="postal_code"							  disabled="true"></input></td>					  </tr>					  <tr>						<td class="label">Country</td>						<td class="wideField" colspan="3"><input value="<?php echo $country; ?>" class="field"  id="country" disabled="true"></input></td>					  </tr>					</table>				</div>								<div class="col-sm-4 margin-top-mobile">					<a href="javascript:void(0);" onclick="confirm_delivery_address();" id="delivery_address_confirm" class="button button-green button-block hover-white shop_btn">Verify</a>				</div>				  </div>			  			</div>						<?php }elseif($showPickup && !$showDelivery){ ?>						<div id="checkout_method" class="checkout-container-content">			  <div class="row form-group">				<div class="col-sm-12 text-center mobile-mb10">				  <div class="full-width highlight" style="padding:3%;background-color:#f0f0f0;border:1px solid #ddd; border-radius:5px;">Pickup</div>				</div>			  </div>			  			  <div id="pickup_section" class="row form-group">				<div class="col-sm-12 text-left">				  <h4>Pickup Location</h4>				  <p>					<?php echo $pickup_address['title']; ?><br/>					<?php echo $pickup_address['display_address']; ?>				  </p>				</div>			  </div>			</div>							<?php }elseif(!$showPickup && $showDelivery){ ?>							<div id="checkout_method" class="checkout-container-content">			  <div class="row form-group">				<div class="col-sm-12 text-center">					<div class="full-width highlight" style="padding:3%;background-color:#f0f0f0;border:1px solid #ddd; border-radius:5px;">Delivery</div>				</div>			  </div>			  			  <div id="delivery_address_section" class="row form-group">				<div class="col-sm-6 col-md-6 col-lg-8">													<input class="form-control input-lg" type="text" id="full_delivery_address" placeholder="Enter your address..." value="<?php echo $full_delivery_address; ?>" name="full_delivery_address" autocomplete="false">										<!-- The table below is used by Google Maps API to post the address as individual value						for street number, city, state, zip code and country -->					<table id="address" style="display:none">					  <tr>						<td class="label">Street address</td>						<td class="slimField">							<input class="field" value="<?php echo $street_number; ?>" id="street_number" name="street_number"	disabled="true"></input>						</td>					  </tr>					  <tr>						<td class="label">Route/Address 2</td>							<td class="wideField" colspan="2">							<input class="field" value="<?php echo $route; ?>" id="route" name="route" disabled="true"></input>						</td>					  </tr>					  <tr>						<td class="label">City</td>						<td class="wideField" colspan="3"><input value="<?php echo $locality; ?>" class="field" id="locality" name="locality" disabled="true"></input></td>					  </tr>					  <tr>						<td class="label">State</td>						<td class="slimField"><input class="field" id="administrative_area_level_1" name="administrative_area_level_1" value="<?php echo $administrative_area_level_1; ?>" disabled="true"></input></td>					<tr>		  					</tr>		  						<td class="label">Zip code</td>						<td class="wideField"><input value="<?php echo $postal_code; ?>" class="field" id="postal_code" name="postal_code" disabled="true"></input></td>					  </tr>					  <tr>						<td class="label">Country</td>						<td class="wideField" colspan="3"><input value="<?php echo $country; ?>" class="field" name="country"  id="country" disabled="true"></input></td>					  </tr>					</table>				</div>								<div class="col-sm-4 margin-top-mobile">					<a href="javascript:void(0);" onclick="confirm_delivery_address();" id="delivery_address_confirm" class="button button-green button-block hover-white shop_btn">Verify</a>				</div>				  </div>			  			</div>						<?php } ?>											</div>				<div id="checkout-form-voucher" class="col-sm-6 col-sm-offset-3 checkout-container clearfix always-hide">			<div class="checkout-container-header full-width">				<h4>Promo Code</h4>			</div>			<div id="checkout_voucher" class="checkout-container-content">			  <div class="row form-group">				<div class="col-sm-8">				  <input name="voucher" class="form-control" type="text" id="voucher">				</div>				<div class="col-sm-4">					<a href="javascript:void(0)" class="button button-blue button-block" style="padding:6px;">Apply</a>				</div>				  </div>			</div>		</div>						<?php if($tipInstalled){ ?>			<div id="checkout-form-voucher" class="col-sm-6 col-sm-offset-3 checkout-container clearfix">				<div class="checkout-container-header full-width">					<h4>Tip</h4>				</div>				<div id="checkout_voucher" class="checkout-container-content">				  <div class="row form-group">					<div class="col-sm-4 col-xs-12 mobile-mb10">						<!-- <a href="javascript:void(0)" onclick="addTip('10')" ><div class="btn button-green shop_btn tip-boxes">10%</div></a> -->						<a href="javascript:void(0)" onclick="addTip('15')"><div class="btn button-green shop_btn tip-boxes">15%</div></a>						<a href="javascript:void(0)" onclick="addTip('18')"><div class="btn button-green shop_btn tip-boxes">18%</div></a>						<a href="javascript:void(0)" onclick="addTip('20')"><div class="btn button-green shop_btn tip-boxes">20%</div></a>					</div>					<div class="col-sm-8 col-xs-12 left-inner-addon">					  <i class="fa fa-usd"></i><input name="tip" class="form-control" type="text" id="tip" value="<?php echo $tip; ?>" placeholder="Other.." >					  <input class="form-control input-lg" type="hidden" id="" placeholder="Enter your address..." value="<?php echo $full_delivery_address; ?>" name="full_delivery_address">					</div>				  </div>				</div>			</div>		<?php }// end if tipInstalled ?>	</div>		<div id="custom-checkout-form_part_2">		<div id="checkout-form-method" class="col-sm-6 col-sm-offset-3 checkout-container clearfix">			<div class="checkout-container-header full-width">				<h4>Order Summary</h4>			</div>			<div id="checkout_method" class="checkout-container-content">			  <div class="row form-group">				<div class="col-sm-12">				  <div class="table-responsive">					  <table class="table table-bordered table-hover">						<thead>						  <tr>							<td class="text-left"><?php echo $column_name; ?></td>							<td class="text-left always-hide"><?php echo $column_model; ?></td>							<td class="text-right"><?php echo $column_quantity; ?></td>							<td class="text-right"><?php echo $column_price; ?></td>							<td class="text-right"><?php echo $column_total; ?></td>						  </tr>						</thead>						<tbody>						  <?php foreach ($products as $product) { ?>						  <tr>							<td class="text-left"><a href="<?php echo $product['href']; ?>"><?php echo $product['name']; ?></a>							  <?php foreach ($product['option'] as $option) { ?>							  <br />							  &nbsp;<small> - <?php echo $option['name']; ?>: <?php echo $option['value']; ?></small>							  <?php } ?>							  <?php if($product['recurring']) { ?>							  <br />							  <span class="label label-info"><?php echo $text_recurring_item; ?></span> <small><?php echo $product['recurring']; ?></small>							  <?php } ?></td>							<td class="text-left always-hide"><?php echo $product['model']; ?></td>							<td class="text-right"><?php echo $product['quantity']; ?></td>							<td class="text-right"><?php echo $product['price']; ?></td>							<td class="text-right"><?php echo $product['total']; ?></td>						  </tr>						  <?php } ?>						  <?php foreach ($vouchers as $voucher) { ?>						  <tr>							<td class="text-left"><?php echo $voucher['description']; ?></td>							<td class="text-left"></td>							<td class="text-right">1</td>							<td class="text-right"><?php echo $voucher['amount']; ?></td>							<td class="text-right"><?php echo $voucher['amount']; ?></td>						  </tr>						  <?php } ?>						</tbody>						<tfoot>						  <?php foreach ($totals as $total) { ?>						  <tr>							<td colspan="3" class="text-right"><strong><?php echo $total['title']; ?>:</strong></td>							<td id="<?php echo $total['id']; ?>" data-amount="<?php echo $total['text']; ?>" class="text-right"><?php echo $total['text']; ?></td>						  </tr>						  <?php } ?>						</tfoot>					  </table>					</div>					<?php echo $payment; ?>				</div>			  </div>			</div>		</div>	</div>		</div><!-- id="map" used for google maps api to verify address in fence or not Do not remove --><div id="map" style="display:none;"></div><script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC8A1it5vpYf-L9LKgFK3lnrykdRnbR6QE&signed_in=false&libraries=places&callback=initAutocomplete"        async defer></script><script type="text/javascript"><!--// Sort the custom fields$('#account .form-group[data-sort]').detach().each(function() {	if ($(this).attr('data-sort') >= 0 && $(this).attr('data-sort') <= $('#account .form-group').length) {		$('#account .form-group').eq($(this).attr('data-sort')).before(this);	}	if ($(this).attr('data-sort') > $('#account .form-group').length) {		$('#account .form-group:last').after(this);	}	if ($(this).attr('data-sort') < -$('#account .form-group').length) {		$('#account .form-group:first').before(this);	}});$('#address .form-group[data-sort]').detach().each(function() {	if ($(this).attr('data-sort') >= 0 && $(this).attr('data-sort') <= $('#address .form-group').length) {		$('#address .form-group').eq($(this).attr('data-sort')).before(this);	}	if ($(this).attr('data-sort') > $('#address .form-group').length) {		$('#address .form-group:last').after(this);	}	if ($(this).attr('data-sort') < -$('#address .form-group').length) {		$('#address .form-group:first').before(this);	}});$('#checkout-registration-panel input[name=\'customer_group_id\']').on('change', function() {	$.ajax({		url: 'index.php?route=checkout/checkout/customfield&customer_group_id=' + this.value,		dataType: 'json',		success: function(json) {			$('#checkout-registration-panel .custom-field').hide();			$('#checkout-registration-panel .custom-field').removeClass('required');			for (i = 0; i < json.length; i++) {				custom_field = json[i];				$('#payment-custom-field' + custom_field['custom_field_id']).show();				if (custom_field['required']) {					$('#payment-custom-field' + custom_field['custom_field_id']).addClass('required');				}			}		},		error: function(xhr, ajaxOptions, thrownError) {			alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);		}	});});$('#checkout-registration-panel input[name=\'customer_group_id\']:checked').trigger('change');//--></script><script type="text/javascript"><!--$('#checkout-registration-panel button[id^=\'button-payment-custom-field\']').on('click', function() {	var node = this;	$('#form-upload').remove();	$('body').prepend('<form enctype="multipart/form-data" id="form-upload" style="display: none;"><input type="file" name="file" /></form>');	$('#form-upload input[name=\'file\']').trigger('click');	if (typeof timer != 'undefined') {    	clearInterval(timer);	}	timer = setInterval(function() {		if ($('#form-upload input[name=\'file\']').val() != '') {			clearInterval(timer);			$.ajax({				url: 'index.php?route=tool/upload',				type: 'post',				dataType: 'json',				data: new FormData($('#form-upload')[0]),				cache: false,				contentType: false,				processData: false,				beforeSend: function() {					$(node).button('loading');				},				complete: function() {					$(node).button('reset');				},				success: function(json) {					$('.text-danger').remove();					if (json['error']) {						$(node).parent().find('input[name^=\'custom_field\']').after('<div class="text-danger">' + json['error'] + '</div>');					}					if (json['success']) {						alert(json['success']);						$(node).parent().find('input[name^=\'custom_field\']').attr('value', json['code']);					}				},				error: function(xhr, ajaxOptions, thrownError) {					alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);				}			});		}	}, 500);});//--></script><script type="text/javascript"><!--$('.date').datetimepicker({	pickTime: false});$('.time').datetimepicker({	pickDate: false});$('.datetime').datetimepicker({	pickDate: true,	pickTime: true});//--></script><script type="text/javascript"><!--$('#checkout-registration-panel select[name=\'country_id\']').on('change', function() {	$.ajax({		url: 'index.php?route=checkout/checkout/country&country_id=' + this.value,		dataType: 'json',		beforeSend: function() {			$('#checkout-registration-panel select[name=\'country_id\']').after(' <i class="fa fa-circle-o-notch fa-spin"></i>');		},		complete: function() {			$('.fa-spin').remove();		},		success: function(json) {			if (json['postcode_required'] == '1') {				$('#checkout-registration-panel input[name=\'postcode\']').parent().parent().addClass('required');			} else {				$('#checkout-registration-panel input[name=\'postcode\']').parent().parent().removeClass('required');			}			html = '<option value=""><?php //echo $text_select; ?></option>';			if (json['zone'] && json['zone'] != '') {				for (i = 0; i < json['zone'].length; i++) {					html += '<option value="' + json['zone'][i]['zone_id'] + '"';					if (json['zone'][i]['zone_id'] == '<?php //echo $zone_id; ?>') {						html += ' selected="selected"';					}					html += '>' + json['zone'][i]['name'] + '</option>';				}			} else {				html += '<option value="0" selected="selected"><?php //echo $text_none; ?></option>';			}			$('#checkout-registration-panel select[name=\'zone_id\']').html(html);		},		error: function(xhr, ajaxOptions, thrownError) {			alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);		}	});});//$('#checkout-registration-panel select[name=\'country_id\']').trigger('change');//--></script><script type="text/javascript"><!--var methodChosenId = '<?php echo $_SESSION['MethodChosenId']?>';if(methodChosenId == 'method_chosen_delivery'){	showSelectedMethodSection('showDeliverySection');}else{	showSelectedMethodSection('showPickupSection');}	function showSelectedMethodSection(id){	if(id == 'showPickupSection'){		$('#showDeliverySection div').removeClass('highlight');		$('#delivery_address_section').hide();		$('#showPickupSection div').addClass('highlight');		$('#pickup_section').show();				$.ajax({			url: 'index.php?route=checkout/checkout/updateMethodChosenId',			type: 'post',			data: { method: id },			beforeSend: function() {				// $('#button-register').button('loading');			},			complete: function() {				// $('#button-register').button('reset');			},			success: function() {				$('#pickup_section').show();			},			error: function(xhr, ajaxOptions, thrownError) {				alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);			}		});			}else if(id == 'showDeliverySection'){		$('#showPickupSection div').removeClass('highlight');		$('#pickup_section').hide();		$('#showDeliverySection div').addClass('highlight');						$.ajax({			url: 'index.php?route=checkout/checkout/updateMethodChosenId',			type: 'post',			data: { method: id },			beforeSend: function() {				// $('#button-register').button('loading');			},			complete: function() {				// $('#button-register').button('reset');			},			success: function() {				$('#delivery_address_section').show();			},			error: function(xhr, ajaxOptions, thrownError) {				alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);			}		});					}		}//ShowTimings Modalfunction showTimings(){		$.ajax({        url: 'index.php?route=common/home/get_location_timings_modal',        dataType: 'html',        success: function(html) {						//var parsedhtml = $.parseHTML( html );						bootbox.dialog({			  //title: "That html",			  message: html,			  buttons: {                    success: {                        label: "Ok",                        className: "btn-success"                    }                }						});						/*           $('#collapse-location-option .panel-body').html(html);			$('#collapse-location-option').parent().find('.panel-heading .panel-title').html('<a href="#collapse-location-option" data-toggle="collapse" data-parent="#accordion" class="accordion-toggle"><?php //echo $text_checkout_option; ?>Choose Location <i class="fa fa-caret-down"></i></a>');						$('#order_pickup_unavailable').attr('id', 'order_pickup');			$('#order_delivery_unavailable').attr('id', 'order_delivery');						$('a[href=\'#collapse-location-option\']').trigger('click');			*/        },        error: function(xhr, ajaxOptions, thrownError) {            alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);        }    });	//alert('This will be timings modal');	return;}	//--></script><script type="text/javascript"><!--function addTip(tipAmt){	var tipPercent = parseInt(tipAmt)/100;		var subTotalAmt = $('#sub_total').attr('data-amount');	var subTotal = 	subTotalAmt.replace('$', '' );		// console.log('tipPercent '+tipPercent);	// console.log('subTotalAmt '+subTotalAmt);	// console.log('subTotal '+subTotal);			var totalTipAmt = subTotal * tipPercent;	if(parseFloat(totalTipAmt) != 0){		totalTipAmt = totalTipAmt.toFixed(2);		$('#tip').val(totalTipAmt);		addTipToSession(totalTipAmt);			}else{		$('#tip').val('0.00');	}		}	$(document).delegate('#tip', 'change', function() {		var tipVal = parseFloat(this.value);	tipVal = tipVal.toFixed(2);	if(tipVal >= 0){		$('#tip').val(tipVal);		addTipToSession(tipVal);	}else{		$('#tip').val('0.00');		}	});	function addTipToSession(totalTipAmt){	$.ajax({		url: 'index.php?route=checkout/checkout/addTipToSession',		type: 'post',		data: { tip: totalTipAmt },		dataType: 'json',		beforeSend: function() {					},		complete: function() {				},		success: function(json) {			if (json['success']) {				console.log('success');				loadOrderSummary();			} else {				console.log('Fail: Tip was not added to session!');			}					},		error: function(xhr, ajaxOptions, thrownError) {			alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);		}	});	}function loadOrderSummary(){	$.ajax({			url: 'index.php?route=checkout/checkout/loadOrderSummary',			dataType: 'html',			beforeSend: function() {				//$('#button-account').button('loading');			},			complete: function() {				//$('#button-account').button('reset');			},			success: function(html) {				$('#custom-checkout-form_part_2').html(html);			},			error: function(xhr, ajaxOptions, thrownError) {				alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);			}		});	}		//--></script><script type="text/javascript"><!--/**	Confirm Button function for method chosen delivery*	Function to post user details via ajax and save in Session*/function confirm_delivery_address(){		// var data	=	{					// 'input_payment_firstname':$('#delivery_firstname').val(),					// 'input_payment_lastname':$('#delivery_lastname').val(),					// 'input_payment_email':$('#delivery_email').val(),					// 'input_payment_telephone':$('#delivery_telephone').val(),					// 'input_payment_fax':$('#delivery_fax').val(),					// 'input_payment_company':$('#delivery_company').val(),					// 'input_payment_address_1':$('#delivery_address_1').val(),					// 'input_payment_address_2':$('#delivery_address_2').val(),					// 'input_payment_postcode':$('#delivery_postcode').val(),					// 'input_payment_city':$('#delivery_city').val(),					// 'input_payment_country':$('#delivery_country_id').val(),					// 'input_payment_zone':$('#delivery_zone_id').val()					// };		// var countryName = $('#delivery_country_id').find('option:selected').attr('id');	// var stateName = $('#delivery_zone_id').find('option:selected').attr('id');		//var fullAddress = $('#delivery_address_1').val()+','+$('#delivery_address_2').val()+','+$('#delivery_city').val()+','+stateName+','+countryName;					var fullAddress = '';	if ( $( "#full_delivery_address" ).length ) {		fullAddress = $('#full_delivery_address').val();	}				//var data = fullAddress;	//alert(fullAddress);		if(fullAddress == '' || typeof(fullAddress) == 'undefined'){		bootbox.alert("<div class='custom_bootbox_error'>Delivery Address Required!</div> ", function() {		});		return false;	}else{					$.ajax({			url: 'index.php?route=common/home/getFenceCoordinates',			dataType: 'json',			success: function(json) {				//$('#geocodeReturn').val('');				var location_coordinates	=	$.parseJSON(json['locationCoordinates']);				var initVal = initMap(location_coordinates, fullAddress);			},			error: function(xhr, ajaxOptions, thrownError) {				alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);			}		});	}	}/* * Functions to verify if the address is in the location range for delivery *//**********************************************************************************/function initMap(blueCoords, address) {	var blueCoords1 = blueCoords;	var map = new google.maps.Map(document.getElementById('map'), {									center: blueCoords1[0],zoom: 5	});		if(blueCoords1 == 'undefined' || blueCoords1 == null){		//setting up the initial coordinates for polygon1		var blueCoords1 = [			{lat: 44.5452, lng: -78.19},			{lat: 44.29213722690972, lng: -77.99989697265624},			{lat: 44.46586801436672, lng: -77.51541967773437},			{lat: 44.697195234376494, lng: -77.67692858886721}		];	}		// Construct a draggable blue Polygon1 with geodesic set to false.	var bermudaPolygon1 = new google.maps.Polygon({		map: map,		paths: blueCoords1,		strokeColor: '#0000FF',		strokeOpacity: 0.8,		strokeWeight: 2,		fillColor: '#0000FF',		fillOpacity: 0.35,		draggable: true,		editable: true,		geodesic: false	});							bermudaPolygon1.setMap(map);	bermudaPolygon1.addListener('mouseup', addLatLng1);			var geocoder = new google.maps.Geocoder();		// document.getElementById('submit').addEventListener('click', function() {	var geocodeVal = geocodeAddress(geocoder, map, bermudaPolygon1, address);		//console.log(geocodeVal);	//return;		// });						}//Handles click events on a map, and adds a new point to the Polyline.function addLatLng1(event) {						var vertices = this.getPath();	//console.log(vertices);	  	var contentString = event.latLng.lat() + ',' + event.latLng.lng() ;  	// Iterate over the vertices.	for (var i =0; i < vertices.getLength(); i++) {		var xy = vertices.getAt(i);			contentString += ':' + xy.lat() + ',' +xy.lng();	}		//to display the values in log	//console.log(contentString); 					}  function geocodeAddress(geocoder, resultsMap, bermudaPolygon1, locationAddress) {  var address = locationAddress;    var data	=	{					'input_payment_firstname'		: '',					'input_payment_lastname'		: '',					'input_payment_email'			: '',					'input_payment_telephone'		: '',					'input_payment_fax'				: '',					'input_payment_company'			: '',					'input_payment_address_1'		: $('#street_number').val(),					'input_payment_address_2'		: $('#route').val(),					'input_payment_postcode'		: $('#postal_code').val(),					'input_payment_city'			: $('#locality').val(),					'input_payment_country'			: $('#country').val(),					'input_payment_zone_code'		: $('#administrative_area_level_1').val(),					'input_payment_zone'			: '',					'full_delivery_address' 		: $('#full_delivery_address').val(),					'street_number'					: $('#street_number').val(),					'route'							: $('#route').val(),					'postal_code'					: $('#postal_code').val(),					'locality'						: $('#locality').val(),					'country'						: $('#country').val(),					'administrative_area_level_1'	: $('#administrative_area_level_1').val()				};          var geoFunc = geocoder.geocode({'address': address}, function(results, status) {	 if (status === google.maps.GeocoderStatus.OK) {		 var contains1 = google.maps.geometry.poly.containsLocation(results[0].geometry.location , bermudaPolygon1);		var street_number	=	$('#street_number').val();			console.log(street_number);		if(street_number == '' || typeof(street_number) == 'undefined'){						bootbox.alert("<div class='custom_bootbox_error'>Sorry this location doesn't deliver to this address. Please try again.</div>", function() {			});			return false;					}		 if(contains1){			// $('#geocodeReturn').val(1);			$.ajax({					  type: 'POST',					  url: 'index.php?route=common/home/add_delivery_address_2_session',					  data: data,					  beforeSend: function() {								  								},					  success: function(response) {								   success_function(response);								   //console.log(response);								},					  error: function(response) {								   //success_function(response);								   console.log(response);								},					  dataType: 'json'					});		 }else{			// $('#geocodeReturn').val(2);			bootbox.alert("<div class='custom_bootbox_error'>Sorry this location doesn't deliver to this address. Please try again.</div>", function() {			});			return false;		 }  	 } else {		//alert('Geocode was not successful for the following reason: ' + status);	 }  });} /**********************************************************************************/function success_function(response){	if(response == 1){		// $('#confirm_view_menu').trigger('click');		bootbox.alert("Delivery Address Succesfully Updated!", function() {			//location.reload();		});		console.log('Hurrah');	}else{		bootbox.alert("Oh-Oh!, something went wrong, please try again.", function() {			location.reload();		});		console.log('Alas');			//location.reload();	}}//https://developers.google.com/maps/documentation/javascript/examples/places-autocomplete-addressformvar placeSearch, autocomplete;var componentForm = {  street_number: 'short_name',  route: 'long_name',  locality: 'long_name',  administrative_area_level_1: 'short_name',  country: 'long_name',  postal_code: 'short_name'};//auto complete address formfunction initAutocomplete() {		if ( $( "#full_delivery_address" ).length ) {		var fullAddress = $('#full_delivery_address').val();		autocomplete = new google.maps.places.Autocomplete(		  /** @type {!HTMLInputElement} */		  (document.getElementById('full_delivery_address')),		  {types: ['geocode']});	  		console.log(autocomplete);	  // When the user selects an address from the dropdown, populate the address	  // fields in the form.	  autocomplete.addListener('place_changed', fillInAddress);	}  }// [START region_fillform]function fillInAddress() {	  // Get the place details from the autocomplete object.  var place = autocomplete.getPlace();  for (var component in componentForm) {    document.getElementById(component).value = '';    document.getElementById(component).disabled = false;  }  // Get each component of the address from the place details  // and fill the corresponding field on the form.  for (var i = 0; i < place.address_components.length; i++) {    var addressType = place.address_components[i].types[0];    if (componentForm[addressType]) {      var val = place.address_components[i][componentForm[addressType]];      document.getElementById(addressType).value = val;    }  }}//--></script><?php } //end if redirect ?>